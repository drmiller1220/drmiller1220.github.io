wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:10){#length(wi_bill_intro)){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:length(wi_bill_intro)){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:dim(wi_bill_intro)[1]){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
View(wi_bill_intro)
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE|council|Council|COUNCIL"), "Committee", NA)
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE|council|Council|COUNCIL"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:dim(wi_bill_intro)[1]){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
View(wi_bill_intro)
wi_bill_intro$intro_by[1416] <- "D"
wi_bill_intro$intro_by[3636] <- "R"
wi_bill_intro$intro_by[3645] <- "R"
wi_bill_intro$intro_by[3648] <- "R"
wi_bill_intro$intro_by[6744] <- "D"
wi_bill_intro$intro_by[7213] <- "D"
wi_bill_intro$intro_by[7977] <- "D"
wi_bill_intro$intro_by[10762] <- "R"
wi_bill_intro$intro_by[11846] <- "R"
wi_bill_intro$intro_by[12378] <- "R"
wi_bill_intro$intro_by[15089] <- "R"
table(wi_bill_intro$intro_by)
View(wi_bill_intro)
wi_bill_intro$uniqid <- paste(wi_bill_intro$session, wi_bill_intro$bill)
wi_bill_intro$state <- "WI"
wi_bill_intro <- subset(wi_bill_intro, select = c(uniqid, state, intro_by))
View(wi_bill_intro)
fwrite(wi_bill_intro, "wi_bill_sponsors", quote = "auto", na = NA)
library(brms)
library(data.table)
library(texreg)
setwd("C:\\Users\\drmil\\Dropbox\\White House Lobbying\\BRMSModels")
set.seed(1213)
################################################################################
# FIGURE 1: CLINTON ACCESS LOGIT
final_df <- fread("..\\final_df_clinton_2021.csv", header = TRUE, stringsAsFactors = FALSE)
final_df_sub <- subset(final_df, select=c(any_visits_perfect, any_visits_perfect1l, self_lobby,
HalfExp100001l, active_cf_sum4,
campaign_donations_sum4, crp_qual_ideo_ind,
ACC, ADV, AER, AGR, ALC, ANI, APP, ART,
AUT, AVI, BAN, BEV, BNK, BUD, CAW, CDT, CHM, CIV, COM,
CON, CPI, CPT, CSP, DEF, DIS, DOC, ECN, EDU, ENG, ENV,
FAM, FIN, FIR, FOO, FOR, FUE, GAM, GOV, HCR, HOM, HOU,
IMM, IND, INS, INT, LAW, LBR, MAN, MAR, MED, MIA, MIN,
MMM, MON, NAT, PHA, POS, REL, RES, RET, ROD, RRR, SCI,
SMB, SPO, TAR, TAX, TEC, TOB, TOR, TOU, TRA, TRD, TRF,
TRU, UNM, URB, UTI, VET, WAS, WEL,
yearperiod, crp_orgnames, Industry.y))
final_df_sub <- final_df_sub[complete.cases(final_df_sub),]
load("Clinton\\Nointer\\brms_nointer_fullsample_clinton_2021.RData")
# model diagnostics
# any divergent transitions?
sum(nuts_params(fit_access_all, pars = "divergent__")$Value)
# any rhats above 1.1?
sort(rhat(fit_access_all), decreasing = TRUE)[1:10]
# neff ratio sufficiently large (>0.001 for all parameters?)
sort(neff_ratio(fit_access_all), decreasing = FALSE)[1:10]
newdata <- data.frame(HalfExp100001l=c(rep(quantile(final_df_sub$HalfExp100001l,
probs = c(0.25), na.rm = TRUE), dim(final_df_sub)[1]),
rep(quantile(final_df_sub$HalfExp100001l,
probs = c(0.50), na.rm = TRUE), dim(final_df_sub)[1]),
rep(quantile(final_df_sub$HalfExp100001l,
probs = c(0.75), na.rm = TRUE), dim(final_df_sub)[1]),
rep(final_df_sub$HalfExp100001l, 7)),
self_lobby=final_df_sub$self_lobby,
any_visits_perfect1l=final_df_sub$any_visits_perfect1l,
crp_qual_ideo_ind=c(rep(final_df_sub$crp_qual_ideo_ind, 7),
rep("I", dim(final_df_sub)[1]),
rep("D", dim(final_df_sub)[1]),
rep("R", dim(final_df_sub)[1])),
active_cf_sum4=c(rep(final_df_sub$active_cf_sum4,3), rep(0,dim(final_df_sub)[1]), rep(1,dim(final_df_sub)[1]*3),rep(final_df_sub$active_cf_sum4,3)),
campaign_donations_sum4=c(rep(final_df_sub$campaign_donations_sum4,3),
rep(0, dim(final_df_sub)[1]),
rep(quantile(final_df_sub$campaign_donations_sum4[which(final_df_sub$active_cf_sum4==1)],
probs = c(0.10),
na.rm = TRUE), dim(final_df_sub)[1]),
rep(quantile(final_df_sub$campaign_donations_sum4[which(final_df_sub$active_cf_sum4==1)],
probs = c(0.50),
na.rm = TRUE), dim(final_df_sub)[1]),
rep(quantile(final_df_sub$campaign_donations_sum4[which(final_df_sub$active_cf_sum4==1)],
probs = c(0.90),
na.rm = TRUE), dim(final_df_sub)[1]),
rep(final_df_sub$campaign_donations_sum4,3)),
ACC=final_df_sub$ACC,
ADV=final_df_sub$ADV,
AER=final_df_sub$AER,
AGR=final_df_sub$AGR,
ALC=final_df_sub$ALC,
ANI=final_df_sub$ANI,
APP=final_df_sub$APP,
ART=final_df_sub$ART,
AUT=final_df_sub$AUT,
AVI=final_df_sub$AVI,
BAN=final_df_sub$BAN,
BEV=final_df_sub$BEV,
BNK=final_df_sub$BNK,
BUD=final_df_sub$BUD,
CAW=final_df_sub$CAW,
CDT=final_df_sub$CDT,
CHM=final_df_sub$CHM,
CIV=final_df_sub$CIV,
COM=final_df_sub$COM,
CON=final_df_sub$CON,
CPI=final_df_sub$CPI,
CPT=final_df_sub$CPT,
CSP=final_df_sub$CSP,
DEF=final_df_sub$DEF,
DIS=final_df_sub$DIS,
DOC=final_df_sub$DOC,
ECN=final_df_sub$ECN,
EDU=final_df_sub$EDU,
ENG=final_df_sub$ENG,
ENV=final_df_sub$ENV,
FAM=final_df_sub$FAM,
FIN=final_df_sub$FIN,
FIR=final_df_sub$FIR,
FOO=final_df_sub$FOO,
FOR=final_df_sub$FOR,
FUE=final_df_sub$FUE,
GAM=final_df_sub$GAM,
GOV=final_df_sub$GOV,
HCR=final_df_sub$HCR,
#HOM=0,
HOU=final_df_sub$HOU,
IMM=final_df_sub$IMM,
IND=final_df_sub$IND,
INS=final_df_sub$INS,
#INT=0,
LAW=final_df_sub$LAW,
LBR=final_df_sub$LBR,
MAN=final_df_sub$MAN,
MAR=final_df_sub$MAR,
MED=final_df_sub$MED,
MIA=final_df_sub$MIA,
#MIN=0,
MMM=final_df_sub$MMM,
MON=final_df_sub$MON,
NAT=final_df_sub$NAT,
PHA=final_df_sub$PHA,
POS=final_df_sub$POS,
REL=final_df_sub$REL,
RES=final_df_sub$RES,
RET=final_df_sub$RET,
ROD=final_df_sub$ROD,
RRR=final_df_sub$RRR,
SCI=final_df_sub$SCI,
SMB=final_df_sub$SMB,
SPO=final_df_sub$SPO,
#TAR=0,
TAX=final_df_sub$TAX,
TEC=final_df_sub$TEC,
TOB=final_df_sub$TOB,
TOR=final_df_sub$TOR,
TOU=final_df_sub$TOU,
TRA=final_df_sub$TRA,
TRD=final_df_sub$TRD,
#TRF=0,
TRU=final_df_sub$TRU,
UNM=final_df_sub$UNM,
URB=final_df_sub$URB,
UTI=final_df_sub$UTI,
VET=final_df_sub$VET,
WAS=final_df_sub$WAS,
WEL=final_df_sub$WEL)
# predicted_values <- fitted(fit_access_all, newdata, summary = TRUE, re_formula = NA)
fi <- as.data.frame(fitted(fit_access_all, newdata, summary = FALSE, re_formula = NA))
