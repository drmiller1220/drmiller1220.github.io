responses$hire1_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app2_prev_pol_exp, "Professional Staffer"), "Committee Staff" , responses$hire1_app2_prev_pol_exp_type)
responses$hire1_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app2_prev_pol_exp, "Communications Director"), "Comms Director" , responses$hire1_app2_prev_pol_exp_type)
responses$hire1_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app2_prev_pol_exp, "Legislative Director"), "Leg Director" , responses$hire1_app2_prev_pol_exp_type)
responses$hire1_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app2_prev_pol_exp, "Think Tank"), "Think Tank Director" , responses$hire1_app2_prev_pol_exp_type)
responses$hire1_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app3_prev_pol_exp, "None"), "None" , responses$hire1_app3_prev_pol_exp_type)
responses$hire1_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app3_prev_pol_exp, "Professional Staffer"), "Committee Staff" , responses$hire1_app3_prev_pol_exp_type)
responses$hire1_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app3_prev_pol_exp, "Communications Director"), "Comms Director" , responses$hire1_app3_prev_pol_exp_type)
responses$hire1_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app3_prev_pol_exp, "Legislative Director"), "Leg Director" , responses$hire1_app3_prev_pol_exp_type)
responses$hire1_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire1_app3_prev_pol_exp, "Think Tank"), "Think Tank Director" , responses$hire1_app3_prev_pol_exp_type)
responses$hire1_app1_prev_pol_exp_type[20]
responses$hire1_app2_prev_pol_exp_type[20]
responses$hire1_app3_prev_pol_exp_type[20]
responses$hire2_app1_bilingual <- ifelse(str_detect(responses$hire2_app1_languages, ","), 1, 0)
responses$hire2_app2_bilingual <- ifelse(str_detect(responses$hire2_app2_languages, ","), 1, 0)
responses$hire2_app3_bilingual <- ifelse(str_detect(responses$hire2_app3_languages, ","), 1, 0)
responses$hire2_app1_prev_lobby_length <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "None"), "None", responses$hire2_app1_prev_lobby_length)
responses$hire2_app1_prev_lobby_length <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "Less than 5 years"), "<5 years", responses$hire2_app1_prev_lobby_length)
responses$hire2_app1_prev_lobby_length <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "5-10 years"), "5-10 years", responses$hire2_app1_prev_lobby_length)
responses$hire2_app1_prev_lobby_length <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "More than 10 years"), ">10 years", responses$hire2_app1_prev_lobby_length)
responses$hire2_app2_prev_lobby_length <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "None"), "None", responses$hire2_app2_prev_lobby_length)
responses$hire2_app2_prev_lobby_length <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "Less than 5 years"), "<5 years", responses$hire2_app2_prev_lobby_length)
responses$hire2_app2_prev_lobby_length <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "5-10 years"), "5-10 years", responses$hire2_app2_prev_lobby_length)
responses$hire2_app2_prev_lobby_length <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "More than 10 years"), ">10 years", responses$hire2_app2_prev_lobby_length)
responses$hire2_app3_prev_lobby_length <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "None"), "None", responses$hire2_app3_prev_lobby_length)
responses$hire2_app3_prev_lobby_length <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "Less than 5 years"), "<5 years", responses$hire2_app3_prev_lobby_length)
responses$hire2_app3_prev_lobby_length <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "5-10 years"), "5-10 years", responses$hire2_app3_prev_lobby_length)
responses$hire2_app3_prev_lobby_length <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "More than 10 years"), ">10 years", responses$hire2_app3_prev_lobby_length)
responses$hire2_app1_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "None"), "None", responses$hire2_app1_prev_lobby_policy_match)
responses$hire2_app1_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "real estate policy"), "Match", responses$hire2_app1_prev_lobby_policy_match)
responses$hire2_app1_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app1_prev_lobby_exp, "defense policy"), "Mismatch", responses$hire2_app1_prev_lobby_policy_match)
responses$hire2_app2_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "None"), "None", responses$hire2_app2_prev_lobby_policy_match)
responses$hire2_app2_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "real estate policy"), "Match", responses$hire2_app2_prev_lobby_policy_match)
responses$hire2_app2_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app2_prev_lobby_exp, "defense policy"), "Mismatch", responses$hire2_app2_prev_lobby_policy_match)
responses$hire2_app3_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "None"), "None", responses$hire2_app3_prev_lobby_policy_match)
responses$hire2_app3_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "real estate policy"), "Match", responses$hire2_app3_prev_lobby_policy_match)
responses$hire2_app3_prev_lobby_policy_match <- ifelse(str_detect(responses$hire2_app3_prev_lobby_exp, "defense policy"), "Mismatch", responses$hire2_app3_prev_lobby_policy_match)
responses$hire2_app1_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Democrat") | str_detect(responses$hire2_app1_prev_pol_exp, "Liberal"), "Liberal", responses$hire2_app1_prev_pol_ideo)
responses$hire2_app1_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Republican") | str_detect(responses$hire2_app1_prev_pol_exp, "Conservative"), "Conservative", responses$hire2_app1_prev_pol_ideo)
responses$hire2_app1_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "None"), "Unknown", responses$hire2_app1_prev_pol_ideo)
responses$hire2_app2_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Democrat") | str_detect(responses$hire2_app2_prev_pol_exp, "Liberal"), "Liberal", responses$hire2_app2_prev_pol_ideo)
responses$hire2_app2_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Republican") | str_detect(responses$hire2_app2_prev_pol_exp, "Conservative"), "Conservative", responses$hire2_app2_prev_pol_ideo)
responses$hire2_app2_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "None"), "Unknown", responses$hire2_app2_prev_pol_ideo)
responses$hire2_app3_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Democrat") | str_detect(responses$hire2_app3_prev_pol_exp, "Liberal"), "Liberal", responses$hire2_app3_prev_pol_ideo)
responses$hire2_app3_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Republican") | str_detect(responses$hire2_app3_prev_pol_exp, "Conservative"), "Conservative", responses$hire2_app3_prev_pol_ideo)
responses$hire2_app3_prev_pol_ideo <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "None"), "Unknown", responses$hire2_app3_prev_pol_ideo)
responses$hire2_app1_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "None"), "None" , responses$hire2_app1_prev_pol_exp_type)
responses$hire2_app1_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Professional Staffer"), "Committee Staff" , responses$hire2_app1_prev_pol_exp_type)
responses$hire2_app1_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Communications Director"), "Comms Director" , responses$hire2_app1_prev_pol_exp_type)
responses$hire2_app1_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Legislative Director"), "Leg Director" , responses$hire2_app1_prev_pol_exp_type)
responses$hire2_app1_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app1_prev_pol_exp, "Think Tank"), "Think Tank Director" , responses$hire2_app1_prev_pol_exp_type)
responses$hire2_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "None"), "None" , responses$hire2_app2_prev_pol_exp_type)
responses$hire2_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Professional Staffer"), "Committee Staff" , responses$hire2_app2_prev_pol_exp_type)
responses$hire2_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Communications Director"), "Comms Director" , responses$hire2_app2_prev_pol_exp_type)
responses$hire2_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Legislative Director"), "Leg Director" , responses$hire2_app2_prev_pol_exp_type)
responses$hire2_app2_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app2_prev_pol_exp, "Think Tank"), "Think Tank Director" , responses$hire2_app2_prev_pol_exp_type)
responses$hire2_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "None"), "None" , responses$hire2_app3_prev_pol_exp_type)
responses$hire2_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Professional Staffer"), "Committee Staff" , responses$hire2_app3_prev_pol_exp_type)
responses$hire2_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Communications Director"), "Comms Director" , responses$hire2_app3_prev_pol_exp_type)
responses$hire2_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Legislative Director"), "Leg Director" , responses$hire2_app3_prev_pol_exp_type)
responses$hire2_app3_prev_pol_exp_type <- ifelse(str_detect(responses$hire2_app3_prev_pol_exp, "Think Tank"), "Think Tank Director" , responses$hire2_app3_prev_pol_exp_type)
colnames(responses)
lobby_hiring_data <- subset(responses, select = c(Uniqid, Registrant, Client, Org1, Org2, Org3, Org4, Org5, age,
educ, income, race, hispanic, resp_ideo, pid, years_exp, mem_congress,
cong_staff, pres_appt, wh_staff, civil_servant, other_exp, any_exp,
position, hiring_exp, cap_ideo, heritage_ideo, client_ideo,
org1_ideo, org2_ideo, org3_ideo, org4_ideo, org5_ideo,
pp_ideo, nra_ideo, hire1_orgtype, hire1_policyarea, hire1_ideo,
hire2_orgtype, hire2_policyarea, hire2_ideo, hire_unif_gov,
hire1_app1_gender, hire1_app2_gender, hire1_app3_gender,
hire1_app1_community, hire1_app2_community, hire1_app3_community,
hire1_app1_race, hire1_app2_race, hire1_app3_race,
hire1_app1_bilingual, hire1_app2_bilingual, hire1_app3_bilingual,
hire1_app1_prev_lobby_length, hire1_app2_prev_lobby_length, hire1_app3_prev_lobby_length,
hire1_app1_prev_lobby_policy_match, hire1_app2_prev_lobby_policy_match, hire1_app3_prev_lobby_policy_match,
hire1_app1_prev_pol_ideo, hire1_app2_prev_pol_ideo, hire1_app3_prev_pol_ideo,
hire1_app1_prev_pol_exp_type, hire1_app2_prev_pol_exp_type, hire1_app3_prev_pol_exp_type,
hire1_app1_rating, hire1_app2_rating, hire1_app3_rating,
hire1_app1_choice, hire1_app2_choice, hire1_app3_choice,
hire2_app1_gender, hire2_app2_gender, hire2_app3_gender,
hire2_app1_community, hire2_app2_community, hire2_app3_community,
hire2_app1_race, hire2_app2_race, hire2_app3_race,
hire2_app1_bilingual, hire2_app2_bilingual, hire2_app3_bilingual,
hire2_app1_prev_lobby_length, hire2_app2_prev_lobby_length, hire2_app3_prev_lobby_length,
hire2_app1_prev_lobby_policy_match, hire2_app2_prev_lobby_policy_match, hire2_app3_prev_lobby_policy_match,
hire2_app1_prev_pol_ideo, hire2_app2_prev_pol_ideo, hire2_app3_prev_pol_ideo,
hire2_app1_prev_pol_exp_type, hire2_app2_prev_pol_exp_type, hire2_app3_prev_pol_exp_type,
hire2_app1_rating, hire2_app2_rating, hire2_app3_rating,
hire2_app1_choice, hire2_app2_choice, hire2_app3_choice
))
View(lobby_hiring_data)
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:10){#length(wi_bill_intro)){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:length(wi_bill_intro)){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:dim(wi_bill_intro)[1]){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
View(wi_bill_intro)
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE|council|Council|COUNCIL"), "Committee", NA)
library(car)
library(data.table)
library(lubridate)
library(stringr)
library(texreg)
library(tidyr)
sessionRecode <- function(x){
tmp <- recode(x,"'2003'='200304';
'2004'='200304';
'2005'='200506';
'2006'='200506';
'2007'='200708';
'2008'='200708';
'2009'='200910';
'2010'='200910';
'2011'='201112';
'2012'='201112';
'2013'='201314';
'2014'='201314';
'2015'='201516';
'2016'='201516';
'2017'='201718';
'2018'='201718';
else=NA")
return(as.character(tmp))
}
setwd("C:\\Users\\drmil\\Google Drive\\Butler-Miller\\Scraping\\WI_BillPositions")
wi_bill_hist <- fread("wi_bill_history.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist_errored <- fread("wi_bill_history_errored.csv", header = TRUE, stringsAsFactors = FALSE)
wi_bill_hist <- rbind(wi_bill_hist, wi_bill_hist_errored)
rm(wi_bill_hist_errored)
# remove errored observations, which have no data other than the bill chamber and number
wi_bill_hist <- wi_bill_hist[which(!is.na(wi_bill_hist$session)),]
# remove 2019 session bills
wi_bill_hist <- wi_bill_hist[which(wi_bill_hist$session!="2019"),]
# keep only "Introduced by" actions
wi_bill_intro <- wi_bill_hist[which(str_detect(wi_bill_hist$action, "Introduced by")),]
# if introduced by a committee, denote as such
wi_bill_intro$intro_by <- ifelse(str_detect(wi_bill_intro$action, "Committee|committee|COMMITTEE|council|Council|COUNCIL"), "Committee", NA)
# isolate names of sponsors
# first, get rid of cosponsors if any so that all that is left is sponsors
wi_bill_intro$sponsors <- ifelse(str_detect(wi_bill_intro$action, "cosponsored"),
str_extract(wi_bill_intro$action, "Introduced by (.*);"),
wi_bill_intro$action)
wi_bill_intro$action_year <- str_extract(wi_bill_intro$action_date, "[0-9]{4}")
shormccarty_indiv <- fread("..\\..\\Lobbying Data\\shormccarty_indiv.tab", sep = "\t", header = TRUE, stringsAsFactors = FALSE)
shormccarty_indiv_wi <- shormccarty_indiv[which(shormccarty_indiv$st=="WI"),]
shormccarty_indiv_wi$lastname <- unlist(lapply(1:dim(shormccarty_indiv_wi)[1], FUN = function(x) str_split(shormccarty_indiv_wi$name, ", ")[[x]][1]))
wi_senators_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2003==1),]
wi_senators_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2004==1),]
wi_senators_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2005==1),]
wi_senators_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2006==1),]
wi_senators_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2007==1),]
wi_senators_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2008==1),]
wi_senators_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2009==1),]
wi_senators_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2010==1),]
wi_senators_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2011==1),]
wi_senators_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2012==1),]
wi_senators_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2013==1),]
wi_senators_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2014==1),]
wi_senators_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2015==1),]
wi_senators_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2016==1),]
wi_senators_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2017==1),]
wi_senators_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$senate2018==1),]
wi_reps_2003 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2003==1),]
wi_reps_2004 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2004==1),]
wi_reps_2005 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2005==1),]
wi_reps_2006 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2006==1),]
wi_reps_2007 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2007==1),]
wi_reps_2008 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2008==1),]
wi_reps_2009 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2009==1),]
wi_reps_2010 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2010==1),]
wi_reps_2011 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2011==1),]
wi_reps_2012 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2012==1),]
wi_reps_2013 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2013==1),]
wi_reps_2014 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2014==1),]
wi_reps_2015 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2015==1),]
wi_reps_2016 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2016==1),]
wi_reps_2017 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2017==1),]
wi_reps_2018 <- shormccarty_indiv_wi[which(shormccarty_indiv_wi$house2018==1),]
for(i in 1:dim(wi_bill_intro)[1]){
bill <- wi_bill_intro[i,]
if(is.na(wi_bill_intro$intro_by[i])){
bill_chamber <- ifelse(bill$action_chamber=="Asm.", "reps", "senators")
bill_year <- bill$action_year
members <- get(paste0("wi_", bill_chamber, "_", bill_year))
members$sponsor <- unlist(lapply(1:dim(members)[1], FUN = function(x) str_detect(bill$sponsors, members$lastname[x])))
sponsors <- members[which(members$sponsor==TRUE),]
num_dems <- sum(sponsors$party=="D")
num_gop <- sum(sponsors$party=="R")
if(num_dems>0 & num_gop==0){
wi_bill_intro$intro_by[i] <- "D"
} else if(num_dems==0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "R"
} else if(num_dems>0 & num_gop>0){
wi_bill_intro$intro_by[i] <- "B"
}
}
print(i)
}
View(wi_bill_intro)
wi_bill_intro$intro_by[1416] <- "D"
wi_bill_intro$intro_by[3636] <- "R"
wi_bill_intro$intro_by[3645] <- "R"
wi_bill_intro$intro_by[3648] <- "R"
wi_bill_intro$intro_by[6744] <- "D"
wi_bill_intro$intro_by[7213] <- "D"
wi_bill_intro$intro_by[7977] <- "D"
wi_bill_intro$intro_by[10762] <- "R"
wi_bill_intro$intro_by[11846] <- "R"
wi_bill_intro$intro_by[12378] <- "R"
wi_bill_intro$intro_by[15089] <- "R"
table(wi_bill_intro$intro_by)
View(wi_bill_intro)
wi_bill_intro$uniqid <- paste(wi_bill_intro$session, wi_bill_intro$bill)
wi_bill_intro$state <- "WI"
wi_bill_intro <- subset(wi_bill_intro, select = c(uniqid, state, intro_by))
View(wi_bill_intro)
fwrite(wi_bill_intro, "wi_bill_sponsors", quote = "auto", na = NA)
